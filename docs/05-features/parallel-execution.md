# Parallel Execution

Orchestrator/Workerãƒ¢ãƒ‡ãƒ«ã«ã‚ˆã‚‹ä¸¦åˆ—ã‚¿ã‚¹ã‚¯å®Ÿè¡Œã€‚

ğŸ”— **å˜ä¸€Workerå®Ÿè¡Œã®è©³ç´°ã¯ @../07-runtime/worker-lifecycle.md ã‚’å‚ç…§**

## æ¦‚è¦

Orchestratorï¼ˆãƒ¡ã‚¤ãƒ³AIï¼‰ãŒè¤‡æ•°ã®Workerï¼ˆã‚µãƒ–ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆï¼‰ã‚’ä¸¦åˆ—ã§å®Ÿè¡Œã™ã‚‹ã€‚
ä¸¦åˆ—å®Ÿé¨“ã¯ `session_group_id` ã§ã‚°ãƒ«ãƒ¼ãƒ”ãƒ³ã‚°ã—ã¦æ¯”è¼ƒå¯èƒ½ã«ã™ã‚‹ã€‚

**å˜ä¸€Workerå®Ÿè¡Œ**: @../07-runtime/worker-lifecycle.md
**ä¸¦åˆ—å®Ÿè¡Œå›ºæœ‰ã®å†…å®¹**: æœ¬ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

## Design Philosophy

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    AI as Orchestrator                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  agentmineã¯ä¸¦åˆ—å®Ÿè¡Œã‚’ã€Œè¨ˆç”»ã€ã—ãªã„ã€‚                            â”‚
â”‚  OrchestratorãŒã€Œè¨ˆç”»ã€ã—ã€agentmineã¯å®Ÿè¡ŒåŸºç›¤ã‚’æä¾›ã™ã‚‹ã€‚        â”‚
â”‚                                                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Orchestratorï¼ˆAIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆï¼‰ã®è²¬å‹™:                            â”‚
â”‚  - ä¸¦åˆ—å®Ÿè¡Œã®è¨ˆç”»ï¼ˆä½•ã‚’ä¸¦åˆ—ã«ã™ã‚‹ã‹ï¼‰                             â”‚
â”‚  - `agentmine worker run --exec --detach` ã®å®Ÿè¡Œ                  â”‚
â”‚  - é€²æ—ç›£è¦–ï¼ˆworker status / waitï¼‰                              â”‚
â”‚  - çµæœãƒãƒ¼ã‚¸ï¼ˆã‚³ãƒ³ãƒ•ãƒªã‚¯ãƒˆè§£æ±ºã€ãƒãƒ¼ã‚¸å®Ÿè¡Œï¼‰                     â”‚
â”‚  - PRä½œæˆ                                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  agentmineã®è²¬å‹™:                                                 â”‚
â”‚  - worktreeä½œæˆ/å‰Šé™¤ï¼ˆgit worktreeã‚’å†…éƒ¨å®Ÿè¡Œï¼‰                     â”‚
â”‚  - ã‚¹ã‚³ãƒ¼ãƒ—é©ç”¨ï¼ˆsparse-checkout + chmodï¼‰                        â”‚
â”‚  - Workerèµ·å‹•/ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç”Ÿæˆï¼ˆworker run/promptï¼‰                 â”‚
â”‚  - ã‚»ãƒƒã‚·ãƒ§ãƒ³è¨˜éŒ²ï¼ˆexit code, artifactsç­‰ï¼‰                       â”‚
â”‚  - Memory Bankæä¾›                                                â”‚
â”‚                                                                  â”‚
â”‚  â€» Workerã¯agentmineã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãªã„                             â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                      â”‚
â”‚  Human (ãƒ¦ãƒ¼ã‚¶ãƒ¼)                                                    â”‚
â”‚    â”‚ ã€Œ3ã¤ã®ã‚¿ã‚¹ã‚¯ã‚’ä¸¦åˆ—ã§å®Ÿè¡Œã—ã¦ã€                                 â”‚
â”‚    â–¼                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                    Orchestrator (Claude Codeç­‰)                 â”‚ â”‚
â”‚  â”‚                                                                  â”‚ â”‚
â”‚  â”‚  1. ã‚¿ã‚¹ã‚¯åˆ†æãƒ»è¨ˆç”»                                             â”‚ â”‚
â”‚  â”‚  2. agentmine worker run --exec --detach                       â”‚ â”‚
â”‚  â”‚     (worktreeä½œæˆ + scopeé©ç”¨ + sessioné–‹å§‹)                    â”‚ â”‚
â”‚  â”‚  3. å®Œäº†å¾…ã¡ï¼ˆworker wait / statusï¼‰                            â”‚ â”‚
â”‚  â”‚  4. ãƒãƒ¼ã‚¸åˆ¤æ–­ãƒ»å®Ÿè¡Œï¼ˆOrchestratorãŒæ±ºå®šï¼‰                       â”‚ â”‚
â”‚  â”‚  5. PRä½œæˆ                                                       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                         â”‚                                            â”‚
â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚
â”‚          â–¼              â–¼              â–¼                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚   Worker    â”‚ â”‚   Worker    â”‚ â”‚   Worker    â”‚                   â”‚
â”‚  â”‚  (Task #3)  â”‚ â”‚  (Task #4)  â”‚ â”‚  (Task #5)  â”‚                   â”‚
â”‚  â”‚             â”‚ â”‚             â”‚ â”‚             â”‚                   â”‚
â”‚  â”‚ worktree-3/ â”‚ â”‚ worktree-4/ â”‚ â”‚ worktree-5/ â”‚                   â”‚
â”‚  â”‚ scopeé©ç”¨æ¸ˆ â”‚ â”‚ scopeé©ç”¨æ¸ˆ â”‚ â”‚ scopeé©ç”¨æ¸ˆ â”‚                   â”‚
â”‚  â”‚             â”‚ â”‚             â”‚ â”‚             â”‚                   â”‚
â”‚  â”‚ â€»agentmine â”‚ â”‚ â€»agentmine â”‚ â”‚ â€»agentmine â”‚                   â”‚
â”‚  â”‚   éä½¿ç”¨    â”‚ â”‚   éä½¿ç”¨    â”‚ â”‚   éä½¿ç”¨    â”‚                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚         â”‚              â”‚              â”‚                             â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             â”‚
â”‚                        â”‚ (exit code / signal)                       â”‚
â”‚                        â–¼                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                   agentmine (Blackboard)                        â”‚ â”‚
â”‚  â”‚                                                                  â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚ â”‚
â”‚  â”‚  â”‚  Tasks   â”‚  â”‚ Sessions â”‚  â”‚ Memory Bank  â”‚                  â”‚ â”‚
â”‚  â”‚  â”‚  çŠ¶æ…‹    â”‚  â”‚  å±¥æ­´    â”‚  â”‚  æ±ºå®šäº‹é …    â”‚                  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚ â”‚
â”‚  â”‚                                                                  â”‚ â”‚
â”‚  â”‚  Orchestratorã®ã¿ãŒã‚¢ã‚¯ã‚»ã‚¹ï¼ˆWorkerã¯éä½¿ç”¨ï¼‰                    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## å®Ÿè¡Œãƒ•ãƒ­ãƒ¼

### Orchestratorã«ã‚ˆã‚‹ä¸¦åˆ—å®Ÿè¡Œ

```
Orchestrator                      agentmine                Git / Workers
 â”‚                                  â”‚                           â”‚
 â”‚  1. ã‚¿ã‚¹ã‚¯å–å¾—                   â”‚                           â”‚
 â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                           â”‚
 â”‚  agentmine task list --json      â”‚                           â”‚
 â”‚  (task #3, #4, #5 ã‚’å–å¾—)        â”‚                           â”‚
 â”‚                                   â”‚                           â”‚
 â”‚  2. Workerèµ·å‹•ï¼ˆä¸¦åˆ—ï¼‰            â”‚                           â”‚
 â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                           â”‚
 â”‚  agentmine worker run 3 --exec --detach                      â”‚
 â”‚  agentmine worker run 4 --exec --detach                      â”‚
 â”‚  agentmine worker run 5 --exec --detach                      â”‚
 â”‚  (worktreeä½œæˆ + scopeé©ç”¨ + sessioné–‹å§‹)                    â”‚
 â”‚                                   â”‚  git worktree add ...     â”‚
 â”‚                                   â”‚  git sparse-checkout ...  â”‚
 â”‚                                   â”‚                     (ä½œæ¥­)â”‚
 â”‚                                   â”‚                           â”‚
 â”‚  3. Workerå®Œäº†å¾…ã¡                â”‚                           â”‚
 â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                           â”‚
 â”‚  agentmine worker wait 3 4 5      â”‚                           â”‚
 â”‚                                   â”‚                           â”‚
 â”‚  4. å®Œäº†å‡¦ç†                       â”‚                           â”‚
 â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                           â”‚
 â”‚  agentmine worker done 3          â”‚                           â”‚
 â”‚  agentmine worker done 4          â”‚                           â”‚
 â”‚  agentmine worker done 5          â”‚                           â”‚
 â”‚                                   â”‚                           â”‚
 â”‚  5. ãƒãƒ¼ã‚¸åˆ¤æ–­ãƒ»å®Ÿè¡Œï¼ˆOrchestratoråˆ¤æ–­ï¼‰                     â”‚
 â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
â”‚  git merge task-3-s101 (æˆåŠŸæ™‚)     â”‚                           â”‚
 â”‚                                   â”‚                           â”‚
```

## Worktree + ã‚¹ã‚³ãƒ¼ãƒ—åˆ¶å¾¡

å„Workerã«ã¯ç‹¬ç«‹ã—ãŸworktreeãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã€ã‚¹ã‚³ãƒ¼ãƒ—åˆ¶å¾¡ãŒé©ç”¨ã•ã‚Œã‚‹ã€‚è©³ç´°ã¯ä»¥ä¸‹ã‚’å‚ç…§ï¼š
- **@../07-runtime/worker-lifecycle.md** (Phase 2: Scope Application)
- **@../03-core-concepts/scope-control.md**

## ãƒ–ãƒ©ãƒ³ãƒæˆ¦ç•¥

```
main â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ æœ¬ç•ªï¼ˆäººé–“ã®ã¿ãƒãƒ¼ã‚¸ï¼‰
  â”‚
baseBranch (ä¾‹: develop) â”€â”€â”€â”€â”€â”€ çµ±åˆãƒ–ãƒ©ãƒ³ãƒï¼ˆsettingsã§å¿…é ˆæŒ‡å®šï¼‰
  â”‚
  â”œâ”€â”€ task-3-s101                # Worker 1
  â”‚     â””â”€â”€ (ä¸¦åˆ—å®Ÿè¡Œä¸­)
  â”‚
  â”œâ”€â”€ task-4-s102                # Worker 2
  â”‚     â””â”€â”€ (ä¸¦åˆ—å®Ÿè¡Œä¸­)
  â”‚
  â””â”€â”€ task-5-s103                # Worker 3
        â””â”€â”€ (ä¸¦åˆ—å®Ÿè¡Œä¸­)
```

### ãƒãƒ¼ã‚¸æˆ¦ç•¥

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ãƒãƒ¼ã‚¸ã¯OrchestratorãŒåˆ¤æ–­                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  ã€agentmineã®å½¹å‰²ã€‘                                                 â”‚
â”‚  ãƒãƒ¼ã‚¸ã—ãªã„ã€‚ãƒãƒ¼ã‚¸åˆ¤æ–­ã¯Orchestratorã®è²¬å‹™ã€‚                     â”‚
â”‚  ã‚¿ã‚¹ã‚¯çŠ¶æ…‹ã¯è¦³æ¸¬å¯èƒ½ãªäº‹å®Ÿï¼ˆã‚»ãƒƒã‚·ãƒ§ãƒ³çŠ¶æ…‹ãƒ»ãƒãƒ¼ã‚¸çŠ¶æ…‹ï¼‰ã§è‡ªå‹•åˆ¤å®šã€‚â”‚
â”‚                                                                     â”‚
â”‚  ã€Orchestratorã®è²¬å‹™ã€‘                                              â”‚
â”‚  1. Workeræ­£å¸¸çµ‚äº†å¾Œã€DoDæ¤œè¨¼ï¼ˆlint/test/buildï¼‰ã‚’å®Ÿè¡Œ              â”‚
â”‚  2. DoDåˆæ ¼ â†’ baseBranchã«ãƒãƒ¼ã‚¸                                    â”‚
â”‚  3. ã‚³ãƒ³ãƒ•ãƒªã‚¯ãƒˆç™ºç”Ÿ â†’ OrchestratorãŒè§£æ±º                           â”‚
â”‚  4. ãƒãƒ¼ã‚¸æˆåŠŸ â†’ ã‚¿ã‚¹ã‚¯ã¯è‡ªå‹•çš„ã« done åˆ¤å®š                          â”‚
â”‚  5. ãƒãƒ¼ã‚¸å¤±æ•—/DoDä¸åˆæ ¼ â†’ å†è©¦è¡Œ or failed                         â”‚
â”‚                                                                     â”‚
â”‚  ã€doneåˆ¤å®šã€‘                                                        â”‚
â”‚  git log --oneline baseBranch..task-branch ãŒç©º                    â”‚
â”‚  = ãƒ–ãƒ©ãƒ³ãƒãŒbaseBranchã«ãƒãƒ¼ã‚¸ã•ã‚ŒãŸ                               â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Note:** `baseBranch` ã¯ settings ã§å¿…é ˆæŒ‡å®šã€‚

## éš”é›¢ãƒ¬ãƒ™ãƒ«

### Level 1: Git Worktreeï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰

è»½é‡ãªéš”é›¢ã€‚åŒä¸€ãƒã‚·ãƒ³ä¸Šã§è¤‡æ•°ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã€‚

```
/project/
â”œâ”€â”€ .git/                    # å…±æœ‰Git
â”œâ”€â”€ main/                    # Orchestratorã®ä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
â”œâ”€â”€ .agentmine/worktrees/
â”‚   â”œâ”€â”€ task-3/             # Worker 1ï¼ˆã‚¹ã‚³ãƒ¼ãƒ—é©ç”¨æ¸ˆï¼‰
â”‚   â”œâ”€â”€ task-4/             # Worker 2ï¼ˆã‚¹ã‚³ãƒ¼ãƒ—é©ç”¨æ¸ˆï¼‰
â”‚   â””â”€â”€ task-5/             # Worker 3ï¼ˆã‚¹ã‚³ãƒ¼ãƒ—é©ç”¨æ¸ˆï¼‰
```

**ãƒ¡ãƒªãƒƒãƒˆ:**
- ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãŒé€Ÿã„
- ãƒ‡ã‚£ã‚¹ã‚¯åŠ¹ç‡ãŒè‰¯ã„
- ã‚¹ã‚³ãƒ¼ãƒ—ã®ç‰©ç†çš„åˆ¶å¾¡ãŒå¯èƒ½

**ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ:**
- ç’°å¢ƒå¤‰æ•°ãƒ»ãƒ—ãƒ­ã‚»ã‚¹ã¯å…±æœ‰

### Level 2: Docker Containerï¼ˆå°†æ¥ï¼‰

å®Œå…¨ãªéš”é›¢ã€‚å„Workerã‚’Dockerã‚³ãƒ³ãƒ†ãƒŠã§å®Ÿè¡Œã€‚

```yaml
# settings snapshot (import/export)
execution:
  parallel:
    isolation: docker
    docker:
      image: node:20
      memory: 4g
      cpu: 2
```

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Host                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚  â”‚   Container      â”‚  â”‚   Container      â”‚                 â”‚
â”‚  â”‚   Task #3        â”‚  â”‚   Task #4        â”‚                 â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚                 â”‚
â”‚  â”‚   â”‚ Worker   â”‚   â”‚  â”‚   â”‚ Worker   â”‚   â”‚                 â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚                 â”‚
â”‚  â”‚   /workspace     â”‚  â”‚   /workspace     â”‚                 â”‚
â”‚  â”‚   (scopeé©ç”¨æ¸ˆ)  â”‚  â”‚   (scopeé©ç”¨æ¸ˆ)  â”‚                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                                                              â”‚
â”‚  Orchestrator (Hostä¸Šã§å®Ÿè¡Œ)                                           â”‚
â”‚    - ã‚³ãƒ³ãƒ†ãƒŠèµ·å‹•ãƒ»ç›£è¦–                                       â”‚
â”‚    - çµæœåé›†ãƒ»ãƒãƒ¼ã‚¸                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## CLIï¼ˆagentmineå´ï¼‰

### ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ï¼ˆOrchestratorå‘ã‘ï¼‰

```bash
# ã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹ï¼ˆæ‰‹å‹•é‹ç”¨æ™‚ã®ã¿ï¼‰
agentmine session start <task-id> --agent <name> --group exp-202501

# ã‚»ãƒƒã‚·ãƒ§ãƒ³çµ‚äº†ï¼ˆWorkerçµ‚äº†å¾Œï¼‰
agentmine session end <session-id> \
  --exit-code 0 \
  --dod-result merged \
  --artifacts '["src/auth.ts", "tests/auth.test.ts"]'
```

### Workerãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç”Ÿæˆï¼ˆOrchestratorå‘ã‘ï¼‰

```bash
# Workerèµ·å‹•ç”¨ã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ç”Ÿæˆ
agentmine worker prompt <task-id> --agent coder
```

### Worktreeç®¡ç†

```
worktreeã¯ `agentmine worker run` ãŒä½œæˆã—ã€`worker done` / `worker cleanup` ãŒå‰Šé™¤ã™ã‚‹ã€‚

# ä¾‹: ä¸¦åˆ—èµ·å‹•
agentmine worker run 3 --exec --detach
agentmine worker run 4 --exec --detach
agentmine worker run 5 --exec --detach

# ä¾‹: ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
agentmine worker cleanup 3
```

**Note:** Workerå‘ã‘ã‚³ãƒãƒ³ãƒ‰ã¯å­˜åœ¨ã—ãªã„ï¼ˆWorkerã¯agentmineã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãªã„ï¼‰ã€‚

## è¨­å®š

```yaml
# settings snapshot (import/export)
execution:
  parallel:
    enabled: true
    maxWorkers: 4              # åŒæ™‚å®Ÿè¡Œæ•°ä¸Šé™
    worktree:
      path: ".agentmine/worktrees/"      # worktreeé…ç½®å…ˆ
      cleanup: true            # å®Œäº†å¾Œã«è‡ªå‹•å‰Šé™¤
    isolation: worktree        # worktree | docker

    # Dockerè¨­å®šï¼ˆisolation: dockeræ™‚ï¼‰
    docker:
      image: node:20
      memory: 4g
      cpu: 2
      networkMode: bridge
```

## Orchestratorã®å®Ÿè£…ä¾‹ï¼ˆå‚è€ƒï¼‰

OrchestratorãŒClaude Codeã®å ´åˆã®ä¸¦åˆ—å®Ÿè¡Œã‚¤ãƒ¡ãƒ¼ã‚¸:

```
Orchestrator (Claude Code) ã®æ€è€ƒ:

1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‹ã‚‰ã€Œtask #3, #4, #5ã‚’ä¸¦åˆ—ã§ã€ã¨ä¾é ¼
2. agentmine task list --json ã§ã‚¿ã‚¹ã‚¯æƒ…å ±å–å¾—
3. å„ã‚¿ã‚¹ã‚¯ã‚’ä¸¦åˆ—èµ·å‹•ï¼ˆworktreeä½œæˆ + sessioné–‹å§‹ï¼‰:
   - agentmine worker run 3 --exec --detach
   - agentmine worker run 4 --exec --detach
   - agentmine worker run 5 --exec --detach
4. å…¨Workerçµ‚äº†ã‚’å¾…ã¤ï¼ˆworker wait / statusï¼‰
5. å„worktreeã§DoDæ¤œè¨¼ï¼ˆlint, test, buildï¼‰
6. DoDåˆæ ¼ â†’ baseBranchã«ãƒãƒ¼ã‚¸
   - git merge task-3-s101
7. ãƒãƒ¼ã‚¸æˆåŠŸ â†’ worker done
   - agentmine worker done 3
   - agentmine worker done 4
   - agentmine worker done 5
```

**Note:** ä¸Šè¨˜ã¯Orchestratorã®å®Ÿè£…æ–¹é‡ã§ã‚ã‚Šã€agentmineãŒåˆ¶å¾¡ã™ã‚‹ã‚‚ã®ã§ã¯ãªã„ã€‚

## References

- **@../07-runtime/worker-lifecycle.md** - Workerå®Ÿè¡Œãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ï¼ˆSSOTï¼‰
- **@../03-core-concepts/orchestrator-worker.md** - Orchestrator/Workerãƒ¢ãƒ‡ãƒ«
- **@./agent-execution.md** - Agentå®Ÿè¡Œãƒ•ãƒ­ãƒ¼
- **@../architecture.md** - ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦
